{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schemas.momentum-ez.org/mez/corridor.state-machine.schema.json",
  "title": "MEZ Corridor Lifecycle State Machine",
  "description": "A declarative lifecycle state machine for corridor operations. This defines allowed transitions between corridor lifecycle states (e.g., DRAFT \u2192 PENDING \u2192 ACTIVE \u2192 HALTED \u2192 DEPRECATED). See also SUSPENDED state for non-emergency pauses.",
  "type": "object",
  "required": [
    "type",
    "states",
    "initial_state",
    "allowed_transitions"
  ],
  "properties": {
    "type": {
      "const": "MEZCorridorStateMachine"
    },
    "version": {
      "type": "string"
    },
    "states": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "string",
        "minLength": 1
      }
    },
    "initial_state": {
      "type": "string",
      "minLength": 1
    },
    "terminal_states": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1
      }
    },
    "allowed_transitions": {
      "type": "array",
      "items": {
        "type": "object",
        "required": [
          "from",
          "to"
        ],
        "properties": {
          "from": {
            "type": "string",
            "minLength": 1
          },
          "to": {
            "type": "string",
            "minLength": 1
          },
          "kind": {
            "type": "string"
          },
          "requires_finality_level": {
            "$ref": "https://schemas.momentum-ez.org/mez/finality-level.schema.json"
          },
          "notes": {
            "type": "string"
          },
          "requires_evidence_vc_types": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Optional list of VC type strings required as evidence for this transition (e.g., MEZCorridorForkAlarmCredential)."
          }
        },
        "additionalProperties": false
      }
    },
    "notes": {
      "type": "string"
    },
    "meta": {
      "type": "object",
      "additionalProperties": true
    }
  },
  "additionalProperties": false
}

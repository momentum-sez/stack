{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://momentum-ez.org/schemas/corporate.formation-application.schema.json",
  "title": "Entity Formation Application",
  "description": "Application for forming a new legal entity in the zone",
  "type": "object",
  "required": [
    "application_id",
    "submitted_at",
    "entity_type",
    "proposed_name",
    "incorporators",
    "registered_office",
    "share_capital",
    "directors",
    "declarations"
  ],
  "properties": {
    "application_id": {
      "type": "string",
      "pattern": "^app:[a-zA-Z0-9-]+$",
      "description": "Unique application identifier"
    },
    "submitted_at": {
      "type": "string",
      "format": "date-time"
    },
    "entity_type": {
      "type": "string",
      "enum": ["llc", "corporation", "partnership", "lp", "llp", "trust", "dao", "foundation"],
      "description": "Type of entity to form"
    },
    "proposed_name": {
      "type": "object",
      "required": ["primary_name"],
      "properties": {
        "primary_name": {
          "type": "string",
          "minLength": 3,
          "maxLength": 200,
          "description": "Proposed entity name"
        },
        "alternative_names": {
          "type": "array",
          "items": { "type": "string" },
          "maxItems": 3,
          "description": "Alternative names if primary is unavailable"
        },
        "trading_names": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Trading names / DBAs"
        }
      }
    },
    "incorporators": {
      "type": "array",
      "minItems": 1,
      "items": {
        "$ref": "#/$defs/person_or_entity"
      },
      "description": "Incorporators / founders"
    },
    "registered_office": {
      "$ref": "#/$defs/address",
      "description": "Registered office address in the zone"
    },
    "registered_agent": {
      "type": "object",
      "properties": {
        "agent_id": {
          "type": "string",
          "description": "Licensed registered agent ID"
        },
        "agent_name": {
          "type": "string"
        },
        "appointment_consent": {
          "type": "boolean",
          "description": "Agent has consented to appointment"
        }
      },
      "description": "Registered agent details (if using CSP)"
    },
    "share_capital": {
      "type": "object",
      "required": ["authorized_capital", "currency"],
      "properties": {
        "authorized_capital": {
          "type": "string",
          "pattern": "^[0-9]+$",
          "description": "Authorized share capital (string decimal)"
        },
        "currency": {
          "type": "string",
          "pattern": "^[A-Z]{3}$"
        },
        "par_value": {
          "type": "string",
          "pattern": "^[0-9.]+$",
          "description": "Par value per share"
        },
        "share_classes": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/share_class"
          }
        },
        "initial_issuance": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/share_issuance"
          },
          "description": "Initial share issuance to founders"
        }
      }
    },
    "directors": {
      "type": "array",
      "minItems": 1,
      "items": {
        "$ref": "#/$defs/director"
      }
    },
    "officers": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/officer"
      }
    },
    "beneficial_owners": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/beneficial_owner"
      },
      "description": "Ultimate beneficial owners (25%+ ownership)"
    },
    "business_activities": {
      "type": "object",
      "properties": {
        "primary_activity": {
          "type": "string",
          "description": "Primary business activity"
        },
        "activity_codes": {
          "type": "array",
          "items": { "type": "string" },
          "description": "ISIC/NACE activity codes"
        },
        "description": {
          "type": "string",
          "maxLength": 2000,
          "description": "Description of business activities"
        },
        "requires_license": {
          "type": "boolean",
          "description": "Whether activities require regulatory license"
        },
        "license_applications": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Associated license application IDs"
        }
      }
    },
    "governance": {
      "type": "object",
      "properties": {
        "articles_of_association": {
          "type": "string",
          "description": "Reference to articles template or custom document"
        },
        "memorandum_of_association": {
          "type": "string",
          "description": "Reference to memorandum template"
        },
        "shareholder_agreement": {
          "type": "boolean",
          "description": "Whether SHA will be entered"
        },
        "financial_year_end": {
          "type": "string",
          "pattern": "^(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$",
          "description": "Financial year end (MM-DD)"
        }
      }
    },
    "declarations": {
      "type": "object",
      "required": ["truthful", "aml_compliance", "sanctions_clearance", "authorized_signatory"],
      "properties": {
        "truthful": {
          "type": "boolean",
          "const": true,
          "description": "Information provided is true and complete"
        },
        "aml_compliance": {
          "type": "boolean",
          "const": true,
          "description": "Will comply with AML/CFT requirements"
        },
        "sanctions_clearance": {
          "type": "boolean",
          "const": true,
          "description": "No sanctions apply to incorporators/UBOs"
        },
        "authorized_signatory": {
          "type": "boolean",
          "const": true,
          "description": "Signatory authorized to submit application"
        },
        "consent_to_checks": {
          "type": "boolean",
          "const": true,
          "description": "Consent to background and sanctions checks"
        }
      }
    },
    "supporting_documents": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "document_type": {
            "type": "string",
            "enum": [
              "passport",
              "national_id",
              "proof_of_address",
              "certificate_of_incorporation",
              "certificate_of_good_standing",
              "board_resolution",
              "power_of_attorney",
              "source_of_funds",
              "business_plan",
              "other"
            ]
          },
          "document_ref": {
            "type": "string",
            "description": "Reference to uploaded document"
          },
          "verified": {
            "type": "boolean"
          }
        }
      }
    },
    "fees": {
      "type": "object",
      "properties": {
        "formation_fee": {
          "type": "string",
          "pattern": "^[0-9.]+$"
        },
        "name_reservation_fee": {
          "type": "string",
          "pattern": "^[0-9.]+$"
        },
        "registered_agent_fee": {
          "type": "string",
          "pattern": "^[0-9.]+$"
        },
        "total_fee": {
          "type": "string",
          "pattern": "^[0-9.]+$"
        },
        "currency": {
          "type": "string",
          "pattern": "^[A-Z]{3}$"
        },
        "payment_reference": {
          "type": "string"
        }
      }
    }
  },
  "$defs": {
    "person_or_entity": {
      "type": "object",
      "required": ["type", "name"],
      "properties": {
        "type": {
          "type": "string",
          "enum": ["natural_person", "legal_entity"]
        },
        "name": {
          "type": "string"
        },
        "did": {
          "type": "string",
          "pattern": "^did:"
        },
        "nationality": {
          "type": "string",
          "pattern": "^[A-Z]{2}$"
        },
        "date_of_birth": {
          "type": "string",
          "format": "date"
        },
        "registration_number": {
          "type": "string"
        },
        "jurisdiction": {
          "type": "string"
        },
        "address": {
          "$ref": "#/$defs/address"
        }
      }
    },
    "address": {
      "type": "object",
      "required": ["country"],
      "properties": {
        "line1": { "type": "string" },
        "line2": { "type": "string" },
        "city": { "type": "string" },
        "state_province": { "type": "string" },
        "postal_code": { "type": "string" },
        "country": {
          "type": "string",
          "pattern": "^[A-Z]{2}$"
        }
      }
    },
    "share_class": {
      "type": "object",
      "required": ["class_name", "authorized_shares"],
      "properties": {
        "class_name": {
          "type": "string",
          "description": "e.g., 'Common', 'Preferred A'"
        },
        "authorized_shares": {
          "type": "string",
          "pattern": "^[0-9]+$"
        },
        "par_value": {
          "type": "string",
          "pattern": "^[0-9.]+$"
        },
        "voting_rights": {
          "type": "boolean",
          "default": true
        },
        "votes_per_share": {
          "type": "integer",
          "default": 1
        },
        "dividend_preference": {
          "type": "string",
          "enum": ["none", "cumulative", "non-cumulative", "participating"]
        },
        "liquidation_preference": {
          "type": "string",
          "pattern": "^[0-9.]+x?$",
          "description": "e.g., '1x', '2x', '1.5'"
        }
      }
    },
    "share_issuance": {
      "type": "object",
      "required": ["recipient", "share_class", "shares", "consideration"],
      "properties": {
        "recipient": {
          "$ref": "#/$defs/person_or_entity"
        },
        "share_class": {
          "type": "string"
        },
        "shares": {
          "type": "string",
          "pattern": "^[0-9]+$"
        },
        "consideration": {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "enum": ["cash", "property", "services", "debt_conversion"]
            },
            "amount": {
              "type": "string",
              "pattern": "^[0-9.]+$"
            },
            "currency": {
              "type": "string",
              "pattern": "^[A-Z]{3}$"
            },
            "description": {
              "type": "string"
            }
          }
        }
      }
    },
    "director": {
      "type": "object",
      "required": ["name", "type"],
      "properties": {
        "name": { "type": "string" },
        "type": {
          "type": "string",
          "enum": ["natural_person", "corporate_director"]
        },
        "did": {
          "type": "string",
          "pattern": "^did:"
        },
        "nationality": {
          "type": "string",
          "pattern": "^[A-Z]{2}$"
        },
        "resident": {
          "type": "boolean",
          "description": "Is zone resident"
        },
        "role": {
          "type": "string",
          "enum": ["director", "chairman", "managing_director", "executive_director", "non_executive_director"]
        },
        "appointment_date": {
          "type": "string",
          "format": "date"
        },
        "consent_to_act": {
          "type": "boolean",
          "const": true
        },
        "fit_and_proper_declaration": {
          "type": "boolean",
          "const": true
        }
      }
    },
    "officer": {
      "type": "object",
      "required": ["name", "position"],
      "properties": {
        "name": { "type": "string" },
        "did": {
          "type": "string",
          "pattern": "^did:"
        },
        "position": {
          "type": "string",
          "enum": ["ceo", "cfo", "coo", "secretary", "treasurer", "other"]
        },
        "position_title": {
          "type": "string"
        },
        "appointment_date": {
          "type": "string",
          "format": "date"
        }
      }
    },
    "beneficial_owner": {
      "type": "object",
      "required": ["name", "ownership_percentage", "control_type"],
      "properties": {
        "name": { "type": "string" },
        "did": {
          "type": "string",
          "pattern": "^did:"
        },
        "type": {
          "type": "string",
          "enum": ["natural_person", "legal_entity"]
        },
        "nationality": {
          "type": "string",
          "pattern": "^[A-Z]{2}$"
        },
        "ownership_percentage": {
          "type": "string",
          "pattern": "^[0-9.]+$",
          "description": "Percentage ownership (string decimal)"
        },
        "control_type": {
          "type": "string",
          "enum": ["direct", "indirect", "control_through_voting", "control_through_contract", "other"]
        },
        "ownership_chain": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "entity_name": { "type": "string" },
              "jurisdiction": { "type": "string" },
              "ownership_percentage": { "type": "string" }
            }
          },
          "description": "Chain of ownership for indirect control"
        },
        "verified": {
          "type": "boolean"
        },
        "verification_date": {
          "type": "string",
          "format": "date"
        }
      }
    }
  }
}

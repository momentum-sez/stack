# v0.4.31 — Smart Asset Receipt Chains (MMR), Inclusion Proofs

This patch extends Smart Assets into a first-class, non-blockchain "state channel" primitive, mirroring corridor receipts while remaining asset-local.

## What landed

### Smart Asset receipt chain primitives

New schemas:

- `smart-asset.receipt.schema.json` — `SmartAssetReceipt`
- `smart-asset.receipt-chain.checkpoint.schema.json` — `SmartAssetReceiptChainCheckpoint`
- `smart-asset.inclusion-proof.schema.json` — `SmartAssetReceiptInclusionProof`

New CLI surface (under `mez asset state ...`):

- `genesis-root` — deterministic genesis root for the asset’s receipt chain (`asset_id` + `purpose`).
- `receipt-init` — build + optionally sign receipts; computes `next_root`.
- `verify` — verify a directory of receipts (schema, hash chain, signatures; optional trust-anchor enforcement).
- `checkpoint` — generate + optionally sign MMR checkpoints over receipt `next_root` leaves.
- `inclusion-proof` — build an inclusion proof for a specific receipt index.
- `verify-inclusion` — verify a receipt + inclusion proof against a signed checkpoint.

### Strict artifact digest semantics for receipts

Artifact graph strict mode (`mez artifact graph verify --strict`) now understands:

- `smart-asset-receipt` digests are semantic (`receipt.next_root`), not raw file-byte sha256.

This aligns smart asset receipts with corridor receipts and enables content-addressed storage keyed by the chain hash.

### Version bump hygiene

- `STACK_SPEC_VERSION` bumped to **0.4.31**.
- Profiles and starter lockfiles updated to match.

## Files of note

- `tools/mez.py`
  - Added `asset_state_genesis_root`, `asset_state_next_root`.
  - Added asset receipt-chain verification, checkpointing and proof commands.
  - Added strict digest handling for `smart-asset-receipt`.
- `schemas/`
  - Added the three smart-asset receipt chain schemas.
- `tests/`
  - Added end-to-end receipt-chain checkpoint + inclusion proof test.
  - Extended strict smart-asset artifact digest test to cover receipts.

## Compatibility

This patch is additive to existing Smart Asset commands (`genesis-init`, `registry-init`, `checkpoint-build`, `attestation-init`, `compliance-eval`, `anchor-verify`).

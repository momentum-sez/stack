# v0.4.24 — Transitive ArtifactRef closure + receipt.zk artifact coverage

This patch strengthens **commitment completeness** by making `--transitive-require-artifacts` a *generic ArtifactRef closure verifier* across receipt-connected artifacts, not just transition type registry locks.

## Key changes

### 1) Generic ArtifactRef transitive closure

- Added `_require_artifact_closure()` which:
  - Resolves artifacts via the generic CAS (`dist/artifacts/<type>/<digest>.*` + `MEZ_ARTIFACT_STORE_DIRS`).
  - Treats `transition-types` lock digests as **commitment roots** and requires all referenced schema/ruleset/circuit digests.
  - Parses JSON/YAML artifacts and recursively follows embedded `ArtifactRef` objects.
  - Applies bounds (`max_nodes`, `max_depth`) to prevent pathological graphs.

### 2) Receipt-level `zk.*` commitments now covered by `--require-artifacts`

- Receipt verification now resolves:
  - `zk.circuit_digest_sha256` → `circuit`
  - `zk.verifier_key_digest_sha256` → `proof-key`
  - `zk.proof_sha256` → `blob`

### 3) Receipt verification now scans for embedded typed ArtifactRefs

- `--require-artifacts` now additionally scans receipts for any typed `ArtifactRef` blocks and requires them.
  - This is future-proof against new schema fields that introduce typed artifact references.

### 4) Tests

- Added tests ensuring:
  - Transitive mode follows ArtifactRefs inside attached VC artifacts.
  - Receipt-level `zk.proof_sha256` is enforced by `--require-artifacts`.


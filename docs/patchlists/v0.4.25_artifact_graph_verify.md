# v0.4.25 â€” Artifact graph verification + strict digest recomputation

This patch introduces a first-class **artifact graph / closure verifier** so every digest commitment in the stack has an obvious, mechanically verifiable resolution path.

## Added

### `msez artifact graph verify`

New command:

```bash
python -m tools.msez artifact graph verify <artifact_type> <digest_sha256> [--store-root <dir> ...] [--strict] [--json] [--out <file>]
python -m tools.msez artifact graph verify --path <local.json|local.yaml> [--store-root <dir> ...] [--strict]
```

Outputs a `MSEZArtifactGraphVerifyReport` containing:

- closure `nodes_total`
- `edges_total`
- `max_depth_seen`
- `missing_total` + missing list
- `digest_mismatch_total` + mismatch list

### Strict digest verification (`--strict`)

`--strict` recomputes artifact digests from on-disk content using the stack's **canonical digest rules per artifact type**:

- `schema`, `ruleset`: JCS canonicalization hash
- `transition-types`: snapshot digest
- `vc`: VC signing-input digest
- `checkpoint`: proof-stripped checkpoint payload digest
- `lawpack`: lawpack component canonicalization digest
- default (`blob`, `circuit`, `proof-key`, etc.): raw bytes sha256

This closes the "filename-only CAS" integrity gap by detecting tampered artifacts whose bytes/semantics no longer match their committed digest.

## Fixed

- `corridor state watcher-attest --store-artifacts` now stores checkpoint artifacts correctly (parameter mismatch fix).

## Tests

- Added `tests/test_artifact_graph_verify.py` covering:
  - missing-node reporting
  - strict digest mismatch detection
  - local file root traversal
  - transition-types commitment-root traversal
